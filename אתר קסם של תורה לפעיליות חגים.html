<!doctype html>
<html lang="he" dir="rtl">
  // Import the functions you need from the SDKs you need
import { initializeApp } from "firebase/app";
import { getAnalytics } from "firebase/analytics";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyAnkW8QmE6Xsf_BQWjsZty9ELsm7ZTe9l0",
  authDomain: "roth-bcebb.firebaseapp.com",
  projectId: "roth-bcebb",
  storageBucket: "roth-bcebb.firebasestorage.app",
  messagingSenderId: "371119701451",
  appId: "1:371119701451:web:f6166267f4f445ef444a4e",
  measurementId: "G-TW1H6JWG3J"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>×¤×•×¨×˜×œ ×™×œ×“×™× â€” × ×§×•×“×•×ª ×•×¤×¨×¡×™×</title>
  <style>
  <script type="module">
     :root{
      --text:#f4f7ff;
      --muted:#c7d2fe;
      --card: rgba(255,255,255,.10);
      --stroke: rgba(255,255,255,.16);
      --shadow: 0 18px 45px rgba(0,0,0,.35);
      --radius: 22px;
      --ok:#34d399;
      --danger:#fb7185;
      --warn:#fbbf24;
      --info:#60a5fa;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans Hebrew", sans-serif;
      color: var(--text);
      min-height:100vh;
      display:flex;
      justify-content:center;
      padding: 18px;
      background:
        radial-gradient(900px 600px at 5% 10%, rgba(56,189,248,.34), transparent 60%),
        radial-gradient(900px 600px at 95% 5%, rgba(167,139,250,.36), transparent 55%),
        radial-gradient(800px 520px at 15% 95%, rgba(251,191,36,.26), transparent 60%),
        radial-gradient(900px 600px at 90% 90%, rgba(52,211,153,.26), transparent 62%),
        linear-gradient(180deg, #0b1220, #08102a 40%, #070a18);
    }

    .app{width: min(1080px, 100%); display:grid; gap:14px;}

    header{
      display:flex; align-items:center; justify-content:space-between;
      padding: 14px 16px;
      background: rgba(255,255,255,.08);
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
    }

    header .title{display:flex; gap:10px; align-items:center;}

    .logo{
      width:40px;height:40px;border-radius:16px;display:grid;place-items:center;
      background: rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.18);
      font-size:18px;
    }

    .pill{
      font-size:12px; padding:6px 10px; border-radius:999px;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.08);
      color: rgba(244,247,255,.90);
    }

    .btn, button{
      cursor:pointer;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.08);
      color: var(--text);
      padding: 10px 12px;
      border-radius: 16px;
      transition: transform .05s ease, border-color .2s ease, background .2s ease;
      box-shadow: 0 10px 22px rgba(0,0,0,.25);
    }
    .btn:hover{border-color: rgba(255,255,255,.35)}
    .btn:active{transform: translateY(1px)}

    .btn.primary{
      background: linear-gradient(135deg, rgba(56,189,248,.22), rgba(167,139,250,.22));
      border-color: rgba(56,189,248,.38);
    }
    .btn.ok{border-color: rgba(52,211,153,.42); background: rgba(52,211,153,.12)}
    .btn.danger{border-color: rgba(251,113,133,.45); background: rgba(251,113,133,.12)}
    .btn.warn{border-color: rgba(251,191,36,.45); background: rgba(251,191,36,.12)}
    .btn.info{border-color: rgba(96,165,250,.45); background: rgba(96,165,250,.12)}

    .icon-btn{width:44px; height:44px; display:grid; place-items:center; border-radius: 16px;}

    main{display:grid; gap:14px; grid-template-columns: 1.25fr .75fr;}
    @media (max-width: 920px){ main{grid-template-columns: 1fr} }

    .card{
      background: var(--card);
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 16px;
      backdrop-filter: blur(12px);
    }

    h1,h2,h3{margin:0 0 10px 0}
    h1{font-size:18px}
    h2{font-size:16px}
    h3{font-size:14px}

    p{margin: 8px 0; color: rgba(244,247,255,.82); line-height:1.5}

    .muted{color: rgba(199,210,254,.92); font-size: 12px}
    .big{font-size: 26px; letter-spacing: .2px; margin: 0 0 6px 0;}
    .divider{height:1px; background: rgba(255,255,255,.14); margin: 12px 0;}

    .row{display:flex; gap:10px; flex-wrap:wrap; align-items:center}
    .grid2{display:grid; grid-template-columns: 1fr 1fr; gap:10px}
    @media (max-width:520px){.grid2{grid-template-columns:1fr}}

    input, textarea{
      width:100%;
      padding: 10px 12px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(0,0,0,.18);
      color: var(--text);
      outline:none;
    }
    textarea{resize: vertical}
    input::placeholder, textarea::placeholder{color: rgba(199,210,254,.75)}

    .list{display:grid; gap:10px}

    .badge{
      font-size:12px; padding: 6px 10px; border-radius: 999px;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.08);
      white-space:nowrap;
    }

    .status{
      font-size:12px; padding: 8px 10px; border-radius: 16px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(0,0,0,.12);
      color: rgba(244,247,255,.86);
    }
    .status.ok{border-color: rgba(52,211,153,.45)}
    .status.bad{border-color: rgba(251,113,133,.50)}
    .status.warn{border-color: rgba(251,191,36,.50)}

    .hidden{display:none !important}

    .modal-backdrop{
      position: fixed; inset: 0;
      background: rgba(0,0,0,.55);
      display:none;
      align-items: center;
      justify-content: center;
      padding: 18px;
      z-index: 9999;
    }
    .modal-backdrop.show{display:flex;}
    .modal{
      width: min(560px, 100%);
      background: rgba(255,255,255,.10);
      border: 1px solid rgba(255,255,255,.18);
      border-radius: 22px;
      box-shadow: 0 22px 60px rgba(0,0,0,.45);
      backdrop-filter: blur(14px);
      padding: 16px;
    }
    .modal .actions{display:flex; gap:10px; justify-content:flex-end; flex-wrap:wrap; margin-top:12px}

    .tight{max-width: 180px}

    @media print{
      body{background:#fff; color:#000; padding:0}
      .app, header, main, aside, .modal-backdrop{display:none !important}
      #printArea{display:block !important}
      .print-grid{display:grid; grid-template-columns: repeat(3, 1fr); gap:10px; padding:14px}
      .print-card{border:1px solid #000; border-radius:10px; padding:10px; font-family: Arial, sans-serif;}
      .print-card .name{font-weight:700; font-size:14px; margin-bottom:6px}
      .print-card .code{font-size:12px}
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="title">
        <div class="logo" aria-hidden="true">ğŸ</div>
        <div>
          <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
            <h1 style="margin:0">×¤×•×¨×˜×œ ×™×œ×“×™× â€” × ×§×•×“×•×ª ×•×¤×¨×¡×™×</h1>
            <span id="modePill" class="pill">××¦×‘: ×‘×™×ª</span>
          </div>
          <div class="muted">×›× ×™×¡×” ×œ×¤×™ <strong>×©×</strong> â€¢ ×©××•×ª ××•×¦×’×™× ×¨×§ ×‘×”×’×“×¨×•×ª â€¢ ×¡× ×›×¨×•×Ÿ ×¢× ×Ÿ (×× ××•×’×“×¨)</div>
        </div>
      </div>

      <div class="row">
        <button id="goHomeBtn" class="btn">×‘×™×ª</button>
        <button id="settingsBtn" class="icon-btn btn" title="×”×’×“×¨×•×ª">âš™ï¸</button>
      </div>
    </header>

    <main>
      <section class="card" id="screenContainer">

        <div id="homeScreen">
          <p class="big">×”×§×œ×“ <strong>×©×</strong> ×›×“×™ ×œ×”×™×›× ×¡</p>
          <label class="muted">×©×</label>
          <input id="kidNameInput" placeholder="×œ××©×œ: × ×‘×• ×¨×•×˜ ××• ×¨×§ × ×‘×•" autocomplete="off" />
          <div class="row" style="margin-top:10px">
            <button id="enterByNameBtn" class="btn primary">×›× ×™×¡×”</button>
            <button id="clearKidNameBtn" class="btn">× ×§×”</button>
          </div>
          <div id="homeStatus" class="status" style="margin-top:10px">×¡×˜×˜×•×¡: ××•×›×Ÿ</div>

          <div class="divider"></div>
          <div id="homePrivacyNote" class="status warn">××¡×™×‘×•×ª ×¤×¨×˜×™×•×ª, ×œ× ××•×¦×’×™× ×›××Ÿ ×©××•×ª ×™×œ×“×™× ××• ×¨×©×™××”. ×›×“×™ ×œ×”×™×›× ×¡ â€” ×”×§×œ×“ ×©×.</div>
        </div>

        <div id="kidPortalScreen" class="hidden">
          <div class="row" style="justify-content:space-between">
            <div>
              <h2>×¤×•×¨×˜×œ ××™×©×™ â€” <span id="kidNameTitle"></span></h2>
              <div class="muted" id="kidNoteTitle"></div>
            </div>
            <button id="backToHomeBtn" class="btn">×—×–×¨×” ×œ×‘×™×ª</button>
          </div>

          <div class="divider"></div>

          <div class="row" style="justify-content:space-between">
            <div>
              <div class="muted">× ×§×•×“×•×ª</div>
              <div id="kidPoints" class="big">0</div>
            </div>
            <div class="row">
              <button id="kidAdd10Btn" class="btn ok">+10</button>
              <button id="kidSub10Btn" class="btn danger">-10</button>
              <button id="kidAdd1Btn" class="btn ok">+1</button>
              <button id="kidSub1Btn" class="btn danger">-1</button>
            </div>
          </div>

          <div class="row" style="margin-top:10px">
            <input id="kidCustomDelta" class="tight" type="number" min="0" placeholder="×›××•×ª" />
            <button id="kidAddCustomBtn" class="btn ok">×”×•×¡×£</button>
            <button id="kidSubCustomBtn" class="btn danger">×”×•×¨×“</button>
          </div>

          <div class="divider"></div>

          <h3>×—× ×•×ª ×¤×¨×¡×™×</h3>
          <div id="prizesStoreList" class="list"></div>
        </div>

        <div id="settingsScreen" class="hidden">
          <div class="row" style="justify-content:space-between">
            <h2>×”×’×“×¨×•×ª (× ×™×”×•×œ)</h2>
            <div class="row">
              <button id="printCardsBtn" class="btn warn">×”×“×¤×¡ ×›×¨×˜×™×¡×™×</button>
              <button id="closeSettingsBtn" class="btn">×¡×’×•×¨</button>
            </div>
          </div>

          <div class="divider"></div>

          <h3>×¨×©×™××ª ×”×™×œ×“×™× (×¨×§ ×›××Ÿ ×¨×•××™× ×©××•×ª)</h3>
          <div id="kidsAdminList" class="list" style="margin-top:10px"></div>

          <div class="divider"></div>

          <h3>×”×•×¡×¤×” ×™×“× ×™×ª (××•×¤×¦×™×•× ×œ×™)</h3>
          <div class="grid2">
            <div>
              <label class="muted">×©× ××œ×</label>
              <input id="newKidName" placeholder='×œ××©×œ: ×¨× ×™ ×¨×•×˜' />
            </div>
            <div>
              <label class="muted">×”×¢×¨×” (××•×¤×¦×™×•× ×œ×™)</label>
              <input id="newKidNote" placeholder='×œ××©×œ: ×›×™×ª×” ×’×³' />
            </div>
          </div>
          <div class="row" style="margin-top:10px">
            <button id="addKidBtn" class="btn ok">×”×•×¡×£ ×™×œ×“ (×¢× ×§×•×“ ××•×˜×•××˜×™)</button>
            <button id="resetDemoDataBtn" class="btn danger">××™×¤×•×¡ × ×ª×•× ×™×</button>
          </div>

          <div class="divider"></div>

          <h3>×”×•×¡×¤×” ××”×™×¨×” ×©×œ ×”×¨×‘×” ×©××•×ª (××•×¤×¦×™×•× ×œ×™)</h3>
          <p class="muted">××¤×©×¨ ×œ×”×“×‘×™×§ ×¨×©×™××” â€œ××œ×•×›×œ×›×ªâ€ â€” ×”××¢×¨×›×ª ×ª×©××•×¨ <strong>×¨×§ ×©××•×ª</strong> ×•×ª×™×™×¦×¨ ×œ×›×œ ××—×“ ×§×•×“.</p>
          <textarea id="bulkKidsInput" rows="6" placeholder="××‘×™×—×™ ×—×™×™× ×©×¨×™×™×‘×¨&#10;××‘×™×©×’ ×¨×™×™× ×¨&#10;××™×™×œ ×‘×Ÿ ××©×”"></textarea>
          <div class="row" style="margin-top:10px">
            <button id="bulkAddKidsBtn" class="btn ok">×”×•×¡×£ ××ª ×›×œ ×”×©××•×ª</button>
            <button id="bulkClearKidsBtn" class="btn">× ×§×”</button>
          </div>
          <div id="bulkKidsStatus" class="status" style="margin-top:10px">×¡×˜×˜×•×¡: ××•×›×Ÿ</div>

          <div class="divider"></div>

          <h3>× ×™×”×•×œ ×¤×¨×¡×™×</h3>
          <p class="muted">××¤×©×¨ ×œ×”×•×¡×™×£ ×¤×¨×¡×™× ×—×“×©×™×. ×©×œ×•×©×ª ×”×¤×¨×¡×™× ×”×§×‘×•×¢×™× ×ª××™×“ ×™×™×©××¨×•: ×¤×•×¤×§×•×¨×Ÿ (7), ×©×œ×•×§×™× (5), ×”×’×¨×œ×” (10).</p>
          <div class="grid2">
            <div>
              <label class="muted">×©× ×¤×¨×¡</label>
              <input id="newPrizeName" placeholder='×œ××©×œ: ×–××Ÿ ××—×©×‘' />
            </div>
            <div>
              <label class="muted">××—×™×¨ ×‘× ×§×•×“×•×ª</label>
              <input id="newPrizeCost" type="number" min="0" placeholder="×œ××©×œ: 12" />
            </div>
          </div>
          <div class="row" style="margin-top:10px">
            <button id="addPrizeBtn" class="btn ok">×”×•×¡×£ ×¤×¨×¡</button>
            <button id="resetPrizesBtn" class="btn danger">××™×¤×•×¡ ×¤×¨×¡×™× (××•×—×§ ×¨×§ ×¤×¨×¡×™× ×©×”×•×¡×¤×ª)</button>
          </div>
          <div id="prizesAdminList" class="list" style="margin-top:10px"></div>
        </div>

      </section>

      <aside class="card">
        <h2>×˜×™×¤</h2>
        <p class="muted">×‘××¡×š ×”×‘×™×ª ×œ× ×¨×•××™× ×©××•×ª. ××ª ×›×œ ×¨×©×™××ª ×”×™×œ×“×™× ×¨×•××™× ×¨×§ ×‘×”×’×“×¨×•×ª (××—×¨×™ ×§×•×“ × ×™×”×•×œ).</p>
      </aside>
    </main>
  </div>

  <div id="adminModalBackdrop" class="modal-backdrop" role="dialog" aria-modal="true" aria-labelledby="adminModalTitle">
    <div class="modal">
      <h3 id="adminModalTitle">×›× ×™×¡×” ×œ×”×’×“×¨×•×ª</h3>
      <div class="muted">×”×›× ×¡ ×§×•×“ × ×™×”×•×œ (4 ×¡×¤×¨×•×ª)</div>
      <div style="margin-top:10px">
        <input id="adminCodeInput" inputmode="numeric" placeholder="â€¢â€¢â€¢â€¢" autocomplete="one-time-code" />
        <div id="adminModalStatus" class="status" style="margin-top:10px">×¡×˜×˜×•×¡: ××•×›×Ÿ</div>
      </div>
      <div class="actions">
        <button id="adminCancelBtn" class="btn">×‘×™×˜×•×œ</button>
        <button id="adminEnterBtn" class="btn primary">×›× ×™×¡×”</button>
      </div>
    </div>
  </div>

  <div id="pickModalBackdrop" class="modal-backdrop" role="dialog" aria-modal="true" aria-labelledby="pickModalTitle">
    <div class="modal">
      <h3 id="pickModalTitle">××¦××ª×™ ×›××” ×™×œ×“×™×</h3>
      <div class="muted">×‘×—×¨ ××ª ×”×™×œ×“ ×©×ª×¨×¦×” ×œ×”×™×›× ×¡ ××œ×™×•</div>
      <div id="pickModalList" class="list" style="margin-top:12px"></div>
      <div class="actions">
        <button id="pickCancelBtn" class="btn">×‘×™×˜×•×œ</button>
      </div>
    </div>
  </div>

  <div id="printArea" class="hidden"></div>

  <!-- ×›× ×™×¡×” ×¢× ×©× ××©×ª××© (×—×•×‘×” ×œ×¤× ×™ ×©×™××•×© ×‘××ª×¨) -->
  <div id="loginModalBackdrop" class="modal-backdrop" role="dialog" aria-modal="true" aria-labelledby="loginModalTitle">
    <div class="modal">
      <h3 id="loginModalTitle">×›× ×™×¡×” ×œ××ª×¨</h3>
      <div class="muted">×”×›× ×¡ ×©× ××©×ª××© ×›×“×™ ×œ×”××©×™×š</div>
      <div style="margin-top:10px">
        <input id="loginUsernameInput" placeholder="×©× ××©×ª××©" autocomplete="username" />
        <div id="loginStatus" class="status" style="margin-top:10px">×¡×˜×˜×•×¡: ××•×›×Ÿ</div>
      </div>
      <div class="actions">
        <button id="loginEnterBtn" class="btn primary">×›× ×™×¡×”</button>
      </div>
      <div class="muted" style="margin-top:10px">×©× ×”××©×ª××© ×”× ×“×¨×©: <strong>×§×¡× ×©×œ ×ª×•×¨×”</strong></div>
    </div>
  </div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
import { getFirestore, doc, getDoc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";

(() => {
  "use strict";

  const STORAGE_KEY = "portal_yeladim_v6";
  const SESSION_LOGIN_KEY = "portal_login_ok";
  const REQUIRED_USERNAME = "×§×¡× ×©×œ ×ª×•×¨×”";

  const CLOUD_CFG_KEY = "portal_firebase_config_v1";
  const CLOUD_DOC_KEY = "portal_cloud_doc_v1";
  const CLOUD_DEFAULT_DOC = "kesem-shel-torah";
  const CLIENT_ID_KEY = "portal_client_id_v1";
  const NL = String.fromCharCode(10);
  const el = (id)=>document.getElementById(id);

  function cryptoId(){
    if (window.crypto && window.crypto.randomUUID) return crypto.randomUUID();
    return Math.random().toString(16).slice(2) + Date.now().toString(16);
  }

  function escapeHtml(str){
    return String(str)
      .replaceAll("&","&amp;")
      .replaceAll("<","&lt;")
      .replaceAll(">","&gt;")
      .replaceAll('"',"&quot;")
      .replaceAll("'","&#039;");
  }

  function normalizeName(s){
    return String(s || "").trim().toLowerCase().replace(/\s+/g, " ");
  }

  // ===== ×¨×©×™××ª ×”×™×œ×“×™× ×©×”×‘××ª (× ×–×¨×¢×ª) =====
  const SEED_TEXT = `××‘×™×’×™×œ ×¢×˜×¨×™
×›×™×ª×” ××³1
1
0 ×¤×¨×¡×™×
×§×•×“: 454
××‘×™×—×™ ×—×™×™× ×©×¨×™×™×‘×¨
×›×™×ª×” ××³1
2
1 ×¤×¨×¡×™×
×§×•×“: 786
××‘×™×©×’ ×¨×™×™× ×¨
×›×™×ª×” ××³1
0
0 ×¤×¨×¡×™×
×§×•×“: 746
××™×™×œ ×‘×Ÿ ××©×”
×›×™×ª×” ××³1
0
0 ×¤×¨×¡×™×
×§×•×“: 659
××™×ª×Ÿ ××”×¨×•×Ÿ
×›×™×ª×” ××³1
0
0 ×¤×¨×¡×™×
×§×•×“: 887
××™×ª×Ÿ ×¦×‘×™
×›×™×ª×” ××³1
1
0 ×¤×¨×¡×™×
×§×•×“: 429
××œ×¨×•××™ ×¡×¤××“×œ
×›×™×ª×” ××³1
0
0 ×¤×¨×¡×™×
×§×•×“: 291
×××™×ª×™ ××™×›××œ ×œ×•×™
×›×™×ª×” ××³1
0
0 ×¤×¨×¡×™×
×§×•×“: 850
××¡×ª×¨ ×©××—×” ×¨×“×”
×›×™×ª×” ××³1
0
0 ×¤×¨×¡×™×
×§×•×“: 977
××¨×™××œ ××•×¨ ×›×”×Ÿ
×›×™×ª×” ××³1
0
0 ×¤×¨×¡×™×
×§×•×“: 759
×‘× ×™×” ××™×¨×–×§× ×“×•×‘
×›×™×ª×” ××³1
0
0 ×¤×¨×¡×™×
×§×•×“: 296
×”×™×œ×” ×›×”×Ÿ
×›×™×ª×” ××³1
0
0 ×¤×¨×¡×™×
×§×•×“: 229
×—×’×™ ××™×ª×Ÿ ×›×”×Ÿ
×›×™×ª×” ××³1
0
0 ×¤×¨×¡×™×
×§×•×“: 642
×™×•× ×ª×Ÿ ×”×œ×¤×’×•×˜
×›×™×ª×” ××³1
0
0 ×¤×¨×¡×™×
×§×•×“: 727
×œ×™××œ ×§×¨× ×¡× ×•×‘
×›×™×ª×” ××³1
0
0 ×¤×¨×¡×™×
×§×•×“: 290
× ×‘×• ×¨×•×˜
×›×™×ª×” ××³1
13
16 ×¤×¨×¡×™×
×§×•×“: 511
× ×”×•×¨××™ × ×™×¡×™×
×›×™×ª×” ××³1
0
0 ×¤×¨×¡×™×
×§×•×“: 218
× ×•×™×” ××¨×™××œ ××’×¨×œ×™
×›×™×ª×” ××³1
0
0 ×¤×¨×¡×™×
×§×•×“: 551
× ×•×™×” ××•×¨×Ÿ
×›×™×ª×” ××³1
0
0 ×¤×¨×¡×™×
×§×•×“: 972
× ×•×™×” ×¡×§×œ×™××¨
×›×™×ª×” ××³1
0
0 ×¤×¨×¡×™×
×§×•×“: 637
× ×•×¢× ×—×™
×›×™×ª×” ××³1
0
0 ×¤×¨×¡×™×
×§×•×“: 797
× ×¢× ××œ×™
×›×™×ª×” ××³1
0
0 ×¤×¨×¡×™×
×§×•×“: 702
× ×¨×™ ×§×“×•×©
×›×™×ª×” ××³1
0
0 ×¤×¨×¡×™×
×§×•×“: 613
×¢×•××¨ ×–××‘ ×§×•×’×Ÿ
×›×™×ª×” ××³1
0
0 ×¤×¨×¡×™×
×§×•×“: 132
×¨×¤××œ ×™×¤×ª
×›×™×ª×” ××³1
1
0 ×¤×¨×¡×™×
×§×•×“: 630
×©×•×”× ×§×•×¤×¨×©×˜×•×§
×›×™×ª×” ××³1
0
0 ×¤×¨×¡×™×
×§×•×“: 126
×›×™×ª×” ××³2(27 ×™×œ×“×™×)
××•×¨×™×” ×œ×•×œ×•
×›×™×ª×” ××³2
0
0 ×¤×¨×¡×™×
×§×•×“: 306
××•×©×¨×™ ××–×•×œ×™
×›×™×ª×” ××³2
0
0 ×¤×¨×¡×™×
×§×•×“: 629
××™××¨×™ ×©××•××œ ×“×’×Ÿ
×›×™×ª×” ××³2
0
0 ×¤×¨×¡×™×
×§×•×“: 379
××™×ª×Ÿ ×¡×’×™×ª
×›×™×ª×” ××³2
0
0 ×¤×¨×¡×™×
×§×•×“: 680
×××¨×™ ×“×¨×•×§
×›×™×ª×” ××³2
0
0 ×¤×¨×¡×™×
×§×•×“: 174
×”×¨××œ ××¨×’×•×œ×™×Ÿ
×›×™×ª×” ××³2
0
0 ×¤×¨×¡×™×
×§×•×“: 917
×–×”×¨ × ×¢××” ×˜×•××™×˜×•
×›×™×ª×” ××³2
0
0 ×¤×¨×¡×™×
×§×•×“: 462
×™×”×•× ×ª×Ÿ ××¡×¤×•×‘
×›×™×ª×” ××³2
0
0 ×¤×¨×¡×™×
×§×•×“: 108
×™×•× ×ª×Ÿ ×–×•×¨× ×•
×›×™×ª×” ××³2
0
0 ×¤×¨×¡×™×
×§×•×“: 656
×™×•×¡×£ ×’×³×¨×‘×™
×›×™×ª×” ××³2
0
0 ×¤×¨×¡×™×
×§×•×“: 546
×œ×‘×™× ×‘×™× ×™××™×Ÿ ××¨×’×¡
×›×™×ª×” ××³2
0
0 ×¤×¨×¡×™×
×§×•×“: 649
×œ×‘×™× ×©××•×œ
×›×™×ª×” ××³2
0
0 ×¤×¨×¡×™×
×§×•×“: 686
×œ×•×¨×Ÿ ×œ×•×‘×˜×•×Ÿ
×›×™×ª×” ××³2
0
0 ×¤×¨×¡×™×
×§×•×“: 866
××™×›××œ ×¤×¨×¥
×›×™×ª×” ××³2
0
0 ×¤×¨×¡×™×
×§×•×“: 301
× ××•×¨ ×™×¦×—×§
×›×™×ª×” ××³2
0
0 ×¤×¨×¡×™×
×§×•×“: 770
× ×’×” ×©×××”
×›×™×ª×” ××³2
0
0 ×¤×¨×¡×™×
×§×•×“: 423
× ×•×¢×” ×—× ×” ×§×œ×™×’×¨
×›×™×ª×” ××³2
0
0 ×¤×¨×¡×™×
×§×•×“: 344
× ×•×¢× ××¡×™×‘× ×”
×›×™×ª×” ××³2
0
0 ×¤×¨×¡×™×
×§×•×“: 946
× ×¢××™ ×¢××œ×™×” ×©×¤×™×¦×¨
×›×™×ª×” ××³2
0
0 ×¤×¨×¡×™×
×§×•×“: 439
× ×ª×× ×œ ×¦×”×™×³×™
×›×™×ª×” ××³2
0
0 ×¤×¨×¡×™×
×§×•×“: 443
×¢×•×¤×¨×™ ×¢×“×™
×›×™×ª×” ××³2
0
0 ×¤×¨×¡×™×
×§×•×“: 833
×¢×™×“×• ×˜×•×‘×•×œ
×›×™×ª×” ××³2
0
0 ×¤×¨×¡×™×
×§×•×“: 386
×¨×™×£ ×œ×™×–×” ×¢×§×œ×™××Ÿ
×›×™×ª×” ××³2
0
0 ×¤×¨×¡×™×
×§×•×“: 677
×©×™ ××œ×™×©×‘×¢ ×©×¨×™×™×‘×¨
×›×™×ª×” ××³2
3
0 ×¤×¨×¡×™×
×§×•×“: 576
×©×§×“ ×‘×¨×§×Ÿ
×›×™×ª×” ××³2
0
0 ×¤×¨×¡×™×
×§×•×“: 329
×©×§×“ ×’×œ×‘×•×¢
×›×™×ª×” ××³2
0
0 ×¤×¨×¡×™×
×§×•×“: 856
×ª××¨ ×§×™×“×¡×˜ ××™× ×©×˜
×›×™×ª×” ××³2
0
0 ×¤×¨×¡×™×
×§×•×“: 532
×›×™×ª×” ××³3(11 ×™×œ×“×™×)
××™×ª×™ × ×ª×Ÿ ×¤×¨×™×™
×›×™×ª×” ××³3
0
0 ×¤×¨×¡×™×
×§×•×“: 350
××œ×™×” ×™×¢×§×‘
×›×™×ª×” ××³3
0
0 ×¤×¨×¡×™×
×§×•×“: 458
×××œ×§×• ××”×¨×˜
×›×™×ª×” ××³3
0
0 ×¤×¨×¡×™×
×§×•×“: 755
××¡×£ ×—×™×™× ×’×•×˜×¡××Ÿ
×›×™×ª×” ××³3
0
0 ×¤×¨×¡×™×
×§×•×“: 104
××¡×£ ×™×¢×§×‘×™
×›×™×ª×” ××³3
0
0 ×¤×¨×¡×™×
×§×•×“: 700
××¨×‘×œ ×ª×•×¨×’×³××Ÿ
×›×™×ª×” ××³3
0
0 ×¤×¨×¡×™×
×§×•×“: 402
×“×•×“ ×—×™×™ ××××¨×”
×›×™×ª×” ××³3
0
0 ×¤×¨×¡×™×
×§×•×“: 695
×“×•×¨ ×—×¤×¥
×›×™×ª×” ××³3
0
0 ×¤×¨×¡×™×
×§×•×“: 990
× ×‘×™×• ××œ××•
×›×™×ª×” ××³3
0
0 ×¤×¨×¡×™×
×§×•×“: 844
× ×•×•×” ×××™× ×•×‘
×›×™×ª×” ××³3
0
0 ×¤×¨×¡×™×
×§×•×“: 421
×¨×¤××œ ×× ×—× ×“×¨×©×Ÿ
×›×™×ª×” ××³3
0
0 ×¤×¨×¡×™×
×§×•×“: 323
×›×™×ª×” ××³4(32 ×™×œ×“×™×)
××‘×™×” ×œ×•×™
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 224
××‘×™×¢×“ ×—×™×™× ×–×•×”×¨
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 742
××’× ×©×œ×•××•×‘
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 558
××•×•×” ×¢×–×¨×™×”
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 604
××•×¨×™ ×‘×Ÿ ×©×˜×¨×™×ª
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 562
××•×¨×™××Ÿ ××•×—× ×”
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 189
××™×™×œ ×‘×œ×•× ×“×¨
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 925
××™×œ×” ×•×™×™×¡
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 756
××™×ª×™ ×‘× ×™××™× ×™
×›×™×ª×” ××³4
1
0 ×¤×¨×¡×™×
×§×•×“: 910
××™×ª×Ÿ ×•×¨×•×Ÿ
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 986
××œ×™×Ÿ ×‘×“×™×¨ ×¢×•×‘×“×™×”
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 951
×××™×ª×™ ×©×œ××” ××œ×™×¢×–×¨
×›×™×ª×” ××³4
1
0 ×¤×¨×¡×™×
×§×•×“: 557
××¨×™××œ ×‘×Ÿ ×™×¦×—×§
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 190
×“× ×™××œ ×•×§× ×™×Ÿ
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 425
×”×“×¡×” ×××××œ×™×”
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 193
×˜×•×”×¨ ××˜×©
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 502
×™×•×‘×œ ×œ×™×‘×¨
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 292
×™×•× ×ª×Ÿ ×™×•×¡×£ ×§×™×™×–×¨
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 599
×™×•×ª× ×‘×Ÿ ×¦×™×•×Ÿ
×›×™×ª×” ××³4
1
0 ×¤×¨×¡×™×
×§×•×“: 424
×™×•×ª× ×©××©×•×Ÿ ×“×™×§×¨
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 376
×™×¢×œ ×•×¡×¨×©×˜×¨×•×
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 741
×™×©×™ ×™×¦×—×§ ×—×¡×Ÿ
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 848
×™×©×™ ×¨× ×“
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 534
×›×¨××™ ×™× ×•×Ÿ ××˜×™××¡
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 348
×œ×‘×™× ×“×•×™×“×•×£
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 897
××™×›××œ ×¦×‘×™ ×©×œ×–×™× ×’×¨
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 809
× ×•×¢× × ×ª×Ÿ ×•×¨×•×Ÿ
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 939
×¢×™×“×Ÿ ×œ××•×¤×¨
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 166
×¢× ×ª ××¡×ª×¨ ×¡×™×™×“×”
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 103
×¨×¤××œ ×™×¢×§×‘ ×¡×™×œ×§×•
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 763
×©×™ ×’×¨×‘×™
×›×™×ª×” ××³4
1
0 ×¤×¨×¡×™×
×§×•×“: 150
×©×™×¨×” ×”×œ×•×™
×›×™×ª×” ××³4
0
0 ×¤×¨×¡×™×
×§×•×“: 605
×›×™×ª×” ××³5(4 ×™×œ×“×™×)
××‘×™×‘ ×¨×•×‘×™×Ÿ
×›×™×ª×” ××³5
0
0 ×¤×¨×¡×™×
×§×•×“: 552
××‘×™×” ×–×™×œ×‘×¨×¤×¨×‘
×›×™×ª×” ××³5
0
0 ×¤×¨×¡×™×
×§×•×“: 704
××‘×™×¢×“ ×©×¨×¥
×›×™×ª×” ××³5
0
0 ×¤×¨×¡×™×
×§×•×“: 535
××•×¨×™×™×Ÿ ×¡×¤×™×¨
×›×™×ª×” ××³5
0
0 ×¤×¨×¡×™×
×§×•×“: 403
×›×™×ª×” ×‘×³1(30 ×™×œ×“×™×)
××‘×™×‘ ×“×•×¨×™
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 220
××‘×¨×”× ×’×‘×¨×™××œ ××™× ×•×—×™×Ÿ
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 623
××•×¤×™×¨ ×’×–×™×ª
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 205
××•×¨××œ ×•×“××•×™×§×¨
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 289
××•×¨××œ ×œ×¨×¨
×›×™×ª×” ×‘×³1
1
0 ×¤×¨×¡×™×
×§×•×“: 996
××™×ª×™ ×”×•×©×× ×“
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 884
××™×ª×Ÿ ×—×•×¡×¨×•×•×Ÿ
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 392
×××” ××¨×“
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 529
××¨×™ ×”×•×œ× ×“×¨
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 107
×’×œ ×œ×™×× ×™
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 974
×“×•×“ ×¢××™×¨× ×™×—×–×§××œ×™
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 406
×“× ×™××œ ××‘×¨×”× ×“××•×¡
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 853
×“× ×™××œ ×™×¦×—×§ ×™×—×–×§××œ
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 830
×“×§×œ ×‘×¨×•×š × ×—×™××¡
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 641
×”×œ×œ ×˜×¨×‘×œ×¡×™
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 466
×˜×œ ×›×”×Ÿ ×—×•×©×Ÿ
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 804
×›×¤×™×¨ ××œ×™
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 351
×œ×™×‘×™ × ×™×¦×” ×›×”×Ÿ
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 921
×œ×™×” ×–×’×•×¨×™
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 333
×œ×™×™×” ×’×‘×¨×™××œ×” ×¤×¨×™ ×‘×•×¡×§×™×œ×”
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 409
××™×” ×”×¨×™×™×ª×™
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 165
××™×” ×©×•×§×¨
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 962
××™×›×œ ×’×œ×™×§
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 481
×¨×•×™ ×—×™×™× ××–×¨×—×™
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 784
×¨×•××™ ×œ×•×™ ××”×¦×¨×™
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 638
×¨×•× ×™ ××¡×ª×¨ ××•××Ÿ
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 836
×¨×•×ª ×¢×× ×•××œ ×¤×¨×™×“×¨
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 133
×¨×™× ×” ×¡××™× ×•×‘
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 202
×©×™ ×•×¨×“×™
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 448
×ª××¨×” ×‘×œ×” ×—×‘×¨×•×Ÿ
×›×™×ª×” ×‘×³1
0
0 ×¤×¨×¡×™×
×§×•×“: 474
×›×™×ª×” ×‘×³2(29 ×™×œ×“×™×)
××‘×¨×”× ××™×ª×Ÿ ×¡×‘×’
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 758
××•×¨ ×”×•×“×™×” ××¨×§×•×¡
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 556
××•×¨×™ ×¨×™×™×–×œ ×¨×‘×™× ×•×‘×™×¥
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 252
××•×¨×™×” ×©×˜×™×¤×œ××Ÿ
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 159
××•×©×¨ ××™×›××œ ×¢×¨×•×¡×™ ×œ×•×™
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 445
××•×©×¨×ª ×˜×¡×¤×”×•×Ÿ
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 851
××—×™×” ×¢×× ×•××œ ×¤×œ××¨
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 886
××™×ª××¨ ×¢×¨××¡×™
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 650
××™×ª×Ÿ ××‘×¨×”× ×§×•×–×¨
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 672
××™×ª×Ÿ ×ª××¨×™
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 493
×”×™×œ×” ×—× ×” ×¡×œ×¢
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 356
×”×œ×œ ×©×¨×” ×©×¤×™×¨×
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 973
×™××™×¨ ×™×¦×—×§ ×’×•×¡×§×™×Ÿ
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 178
×™×”×•× ×ª×Ÿ ××©×” ×›×”×Ÿ
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 935
×™×•×œ×™ ×•×™×§×˜×•×¨×™ ×¡×¢××ª ×‘×•×©×¨×™
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 960
×œ×™××• ×“×•×“ ×—×Ÿ
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 256
×œ×™××œ ×× ×“××™×™×”×•
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 970
×œ×™×‘×¨ ×›×‘×¨×”
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 399
×œ×™×¨×Ÿ ×¨×•×–× ×•×‘×™×¥
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 867
××™×” ×—×Ÿ
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 823
××œ××›×™ ×¤×¨× ×§
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 237
× ×•×¢×” ×’×‘×¨×™××œ×” ×–×•×’×¨×¤×•×¡
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 607
× ×•×¢×” ×××™×¨
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 161
× ×•×¢×” ×§×¨×‘×™×¥
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 801
× ×¢××™ ×—×™×™××•×‘
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 764
×¡×¤×™×¨ ×’×³×•× ×¡Ö¿
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 577
×¢×•××¨ ×§×œ×•×’××Ÿ
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 505
×¨×•× ×™ ××¨×™× ×¦×™×©×œ×‘×™×¥
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 955
×¨×¤××œ ×§×œ×™×™×Ÿ
×›×™×ª×” ×‘×³2
0
0 ×¤×¨×¡×™×
×§×•×“: 295
×›×™×ª×” ×‘×³3(7 ×™×œ×“×™×)
××‘×™×”×•× ×™×¢×§×‘ ×’×³×™× ×•×¨×™×”
×›×™×ª×” ×‘×³3
0
0 ×¤×¨×¡×™×
×§×•×“: 467
××“×™×¨ ×‘×§×•×œ×˜×•×‘
×›×™×ª×” ×‘×³3
0
0 ×¤×¨×¡×™×
×§×•×“: 541
××œ×™××‘ ××©×” ×œ×•×™
×›×™×ª×” ×‘×³3
0
0 ×¤×¨×¡×™×
×§×•×“: 682
×“×•×“ ××œ×•× ×™
×›×™×ª×” ×‘×³3
0
0 ×¤×¨×¡×™×
×§×•×“: 644
× ×•×¢× ×©××•××˜
×›×™×ª×” ×‘×³3
0
0 ×¤×¨×¡×™×
×§×•×“: 415
×¨×‘×™×“ ×›×”×Ÿ
×›×™×ª×” ×‘×³3
0
0 ×¤×¨×¡×™×
×§×•×“: 230
×¨×¤××œ ×›×”×Ÿ
×›×™×ª×” ×‘×³3
0
0 ×¤×¨×¡×™×
×§×•×“: 119
×›×™×ª×” ×‘×³4(30 ×™×œ×“×™×)
××‘×™×©×™ × ×•×¢× ×œ×•×™× ×¡×•×Ÿ
×›×™×ª×” ×‘×³4
5
0 ×¤×¨×¡×™×
×§×•×“: 550
××“×œ ×©××•××œ×™
×›×™×ª×” ×‘×³4
7
0 ×¤×¨×¡×™×
×§×•×“: 359
××•×¨×” ×’×™× ×” ××‘×¨××•×‘×¡×§×™
×›×™×ª×” ×‘×³4
2
0 ×¤×¨×¡×™×
×§×•×“: 207
××•×¨×•×Ÿ ××•×¡×™×•×£
×›×™×ª×” ×‘×³4
5
0 ×¤×¨×¡×™×
×§×•×“: 707
××™×ª× ×“×•×“ ×˜× ×
×›×™×ª×” ×‘×³4
1
0 ×¤×¨×¡×™×
×§×•×“: 446
××™×ª×Ÿ ×××¨×§
×›×™×ª×” ×‘×³4
7
0 ×¤×¨×¡×™×
×§×•×“: 101
××œ×™××‘ ××©×” ×™×•×“×™×¥
×›×™×ª×” ×‘×³4
2
0 ×¤×¨×¡×™×
×§×•×“: 625
××¨×™××œ ×©××¨
×›×™×ª×” ×‘×³4
56
0 ×¤×¨×¡×™×
×§×•×“: 697
×“× ×™××œ ×‘×Ÿ ×¤×•×¨×ª
×›×™×ª×” ×‘×³4
1
0 ×¤×¨×¡×™×
×§×•×“: 280
×”×™×œ×” ×“×‘×™×¨
×›×™×ª×” ×‘×³4
6
0 ×¤×¨×¡×™×
×§×•×“: 580
×”×¨××œ ×œ×™×‘×¨×–×•×Ÿ
×›×™×ª×” ×‘×³4
1
0 ×¤×¨×¡×™×
×§×•×“: 274
×˜×œ×™ ×©×™×•×‘×™×¥
×›×™×ª×” ×‘×³4
1
0 ×¤×¨×¡×™×
×§×•×“: 933
×™××™×¨ ×™×¢×§×‘ ×©××•××œ×™
×›×™×ª×” ×‘×³4
1
0 ×¤×¨×¡×™×
×§×•×“: 134
×™×•×¡×£ ×¡×™××œ×•×
×›×™×ª×” ×‘×³4
2
0 ×¤×¨×¡×™×
×§×•×“: 362
×™×•×ª× ×©×¨×¢×‘×™
×›×™×ª×” ×‘×³4
1
0 ×¤×¨×¡×™×
×§×•×“: 854
×™×¢×œ ×¨×—×œ ×¤×¨×‘×¨
×›×™×ª×” ×‘×³4
2
0 ×¤×¨×¡×™×
×§×•×“: 154
×™×¤×” ×™×©×¨××œ×™
×›×™×ª×” ×‘×³4
1
0 ×¤×¨×¡×™×
×§×•×“: 696
×œ×‘×™× ×©××¢×•×Ÿ
×›×™×ª×” ×‘×³4
1
0 ×¤×¨×¡×™×
×§×•×“: 487
×œ×™××Ÿ ×—×–×Ÿ
×›×™×ª×” ×‘×³4
1
0 ×¤×¨×¡×™×
×§×•×“: 657
×œ×™×‘ ××¡×ª×¨ ××œ×™×–×” ×©×˜×™×™× ×‘×¨×’×¨
×›×™×ª×” ×‘×³4
1
0 ×¤×¨×¡×™×
×§×•×“: 245
×œ×™×” ×›×”×Ÿ
×›×™×ª×” ×‘×³4
1
0 ×¤×¨×¡×™×
×§×•×“: 579
××™×” ×‘×¨× ×©×˜×™×™×Ÿ
×›×™×ª×” ×‘×³4
5
0 ×¤×¨×¡×™×
×§×•×“: 473
××™×›××œ ××•×›×ª×¨
×›×™×ª×” ×‘×³4
4
0 ×¤×¨×¡×™×
×§×•×“: 459
× ×•×™×” ××¡×¨×£
×›×™×ª×” ×‘×³4
50
1 ×¤×¨×¡×™×
×§×•×“: 303
×¢×™×œ××™ ×¡×™××•×Ÿ ×‘× ×™×©×•
×›×™×ª×” ×‘×³4
1
0 ×¤×¨×¡×™×
×§×•×“: 559
×¢××œ×™×” ××œ×¢×™
×›×™×ª×” ×‘×³4
46
0 ×¤×¨×¡×™×
×§×•×“: 699
×¨×—×œ ××œ××“
×›×™×ª×” ×‘×³4
1
0 ×¤×¨×¡×™×
×§×•×“: 404
×¨× ×™ ××”×¨×•× ×™
×›×™×ª×” ×‘×³4
5
0 ×¤×¨×¡×™×
×§×•×“: 885
×¨×¤××œ ××¨×“×›×™ ×××™×¨×•×‘
×›×™×ª×” ×‘×³4
1
0 ×¤×¨×¡×™×
×§×•×“: 391
×©×™×¨×” ×–×’×•×¨×™
×›×™×ª×” ×‘×³4
11
0 ×¤×¨×¡×™×
×§×•×“: 438
×›×™×ª×” ×‘×³5(32 ×™×œ×“×™×)
××‘×™×’×™×œ ××“×œ×¨
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 568
××’× ×‘×Ÿ ××¨×™
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 875
××“× ×¨×‘×™×‘
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 397
××™×™×¨ ×¤×¨×¡×¨
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 760
××™×ª×™ × ×™×¡×™× ××©×¨××£
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 544
××™×ª× ×¤×œ×“
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 590
××œ×•×Ÿ ×©×¤×™×¥
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 819
×××” ×©×œ×•××•×‘
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 457
×××™×ª×™ ××§××œ
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 440
××¨×‘×œ ×›×”×Ÿ
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 367
×‘× ×™××™×Ÿ ×¨×¤××œ×™
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 312
×’×¤×Ÿ ×–×›×¨×™×” × ×—××™××¡
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 278
×”×¨××œ ×©×‘×ª××™
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 433
×™×”×•×“×” ×©×œ××” ×¤×¨×¥
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 143
×™×”×œ×™ ××”×•×‘×” ×™×•×¡×§×•×‘×™×¥
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 492
×™×¢×œ ×©× ×™
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 197
×™×¨×“×Ÿ ××’×¡×™
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 847
×××™×” ×§×‘×œ×Ÿ
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 203
×××™×” ×¨×—×œ ×“×™× ××™
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 111
××’×Ÿ ×™×”×•×“×” ×”×œ×•×™×¤×™×™× ×‘×¨×’
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 882
××™×” ×›×”×Ÿ
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 327
××™×›××œ ×‘×¨×•×š ×œ×™×˜×‘×™× ×•×‘
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 435
××™×›××œ ×™×”×•×“×” ×–×™×•
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 781
××©×” ×’×•×¨×•×‘×™×¥×³ ××‘×¨
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 430
××©×•×© ×‘×¨×•×š ×§× ×•×‘×œ
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 410
× ×•×™×” ×™×•× ×˜×•×‘
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 346
× ×•×¢×” ××¨××”
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 957
× ×•×¢× ×’× ×“×™×œ
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 813
× ×™×ª××™ ××™××œ ×¤×¨×™×–×“×”
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 248
× ×¢× ×œ××” ×¤×œ×•×§×•×‘×¡×§×™
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 729
×¢××™×ª ××›××œ ×—×Ÿ
×›×™×ª×” ×‘×³5
0
0 ×¤×¨×¡×™×
×§×•×“: 608
×¢× ×‘×¨ ×—×›×`;

  function parseSeedNames(text){
    const lines = String(text || "").split(/\r?\n/).map(s=>s.trim()).filter(Boolean);
    const out = [];
    const seen = new Set();

    function isGroupHeader(s){
      return s.startsWith("×›×™×ª×”") && s.includes("(") && s.includes("×™×œ×“");
    }

    function isNameLine(s){
      if(!s) return false;
      if(isGroupHeader(s)) return false;
      if(s.startsWith("×›×™×ª×”")) return false;
      if(/^\d+$/.test(s)) return false;
      if(s.includes("×¤×¨×¡×™×")) return false;
      if(s.startsWith("×§×•×“")) return false;
      const heb = s.match(/[×-×ª]/g);
      if(!heb || heb.length < 2) return false;
      const words = s.split(/\s+/).filter(w=>/[×-×ª]/.test(w));
      return words.length >= 2;
    }

    for(const s of lines){
      if(!isNameLine(s)) continue;
      const name = s.replace(/\s+/g, " ").trim();
      const key = normalizeName(name);
      if(seen.has(key)) continue;
      seen.add(key);
      out.push(name);
    }

    return out;
  }

  // ===== ×¤×¨×¡×™× ×§×‘×•×¢×™× =====
  const FIXED_PRIZES = [
    { name: "×¤×•×¤×§×•×¨×Ÿ", cost: 7 },
    { name: "×©×œ×•×§×™×", cost: 5 },
    { name: "×”×’×¨×œ×”", cost: 10 }
  ];

  function makeDefaultState(){
    return {
      adminCodes: ["2590"],
      kids: [],
      prizes: FIXED_PRIZES.map(p=>({ id: cryptoId(), name: p.name, cost: p.cost, fixed: true }))
    };
  }

  function loadState(){
    const raw = localStorage.getItem(STORAGE_KEY);
    if(!raw) return null;
    try{ return JSON.parse(raw); }catch{ return null; }
  }

  function saveStateLocal(){
    localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
  }

  // ===== ×¢× ×Ÿ (Firebase Firestore) =====
  let cloud = {
    enabled: false,
    app: null,
    db: null,
    unsub: null,
    lastWriteAt: 0,
    clientId: null,
    docId: null,
  };

  function getClientId(){
    let id = localStorage.getItem(CLIENT_ID_KEY);
    if(!id){ id = cryptoId(); localStorage.setItem(CLIENT_ID_KEY, id); }
    return id;
  }

  function getCloudConfig(){
    const raw = localStorage.getItem(CLOUD_CFG_KEY);
    if(!raw) return null;
    try{ return JSON.parse(raw); }catch{ return null; }
  }

  function setCloudConfig(obj){
    localStorage.setItem(CLOUD_CFG_KEY, JSON.stringify(obj));
  }

  function getCloudDocId(){
    return localStorage.getItem(CLOUD_DOC_KEY) || CLOUD_DEFAULT_DOC;
  }

  function setCloudDocId(id){
    localStorage.setItem(CLOUD_DOC_KEY, id);
  }

  async function cloudInitIfPossible(){
    const cfg = getCloudConfig();
    if(!cfg) return false;
    try{
      cloud.app = initializeApp(cfg);
      cloud.db = getFirestore(cloud.app);
      cloud.enabled = true;
      cloud.clientId = getClientId();
      cloud.docId = getCloudDocId();
      return true;
    }catch(err){
      console.warn("Cloud init failed", err);
      cloud.enabled = false;
      return false;
    }
  }

  async function cloudPullOnce(){
    if(!cloud.enabled || !cloud.db) return null;
    try{
      const ref = doc(cloud.db, "portals", cloud.docId);
      const snap = await getDoc(ref);
      if(!snap.exists()) return null;
      const data = snap.data();
      if(!data || !data.state) return null;
      return data;
    }catch(err){
      console.warn("Cloud pull failed", err);
      return null;
    }
  }

  async function cloudPushNow(){
    if(!cloud.enabled || !cloud.db) return;
    try{
      const ref = doc(cloud.db, "portals", cloud.docId);
      const updatedAt = Date.now();
      cloud.lastWriteAt = updatedAt;
      await setDoc(ref, { state, updatedAt, clientId: cloud.clientId }, { merge: false });
    }catch(err){
      console.warn("Cloud push failed", err);
    }
  }

  let cloudPushTimer = null;
  function cloudPushDebounced(){
    if(!cloud.enabled) return;
    if(cloudPushTimer) clearTimeout(cloudPushTimer);
    cloudPushTimer = setTimeout(()=> cloudPushNow(), 450);
  }

  function cloudSubscribe(onRemote){
    if(!cloud.enabled || !cloud.db) return;
    if(cloud.unsub) cloud.unsub();
    const ref = doc(cloud.db, "portals", cloud.docId);
    cloud.unsub = onSnapshot(ref, (snap)=>{
      if(!snap.exists()) return;
      const data = snap.data();
      if(!data || !data.state) return;
      const updatedAt = Number(data.updatedAt||0);
      const fromMe = data.clientId && data.clientId === cloud.clientId;
      if(fromMe && updatedAt && updatedAt === cloud.lastWriteAt) return;
      onRemote(data);
    }, (err)=> console.warn("Cloud subscribe error", err));
  }

  function saveState(){
    saveStateLocal();
    cloudPushDebounced();
  }

  let state = loadState();

  // ===== UI: ×¢× ×Ÿ (×”×•×¡×¤×” ×“×™× ××™×ª ×œ××¡×š ×”×’×“×¨×•×ª) =====
  function ensureCloudUi(){
    const container = el("settingsScreen");
    if(!container || el("cloudCfg")) return;

    const div = document.createElement("div");
    div.innerHTML = `
      <div class="divider"></div>
      <h3>×¡× ×›×¨×•×Ÿ ×¢× ×Ÿ (××•×ª×• ××™×“×¢ ×‘×›×œ ××—×©×‘)</h3>
      <p class="muted">×›×“×™ ×œ×¡× ×›×¨×Ÿ ×‘×™×Ÿ ××—×©×‘×™× ×¦×¨×™×š Firebase + Firestore. ×¤×¢× ××—×ª ××“×‘×™×§×™× ×›××Ÿ ××ª ×”-Config, ×•××– ×”× ×ª×•× ×™× × ×©××¨×™× ×‘×¢× ×Ÿ.</p>
      <div id="cloudStatus" class="status" style="margin-top:10px">×¢× ×Ÿ: ×œ× ××•×’×“×¨</div>

      <div class="divider"></div>
      <label class="muted">Firebase config (JSON)</label>
      <textarea id="cloudCfg" rows="6" placeholder='{"apiKey":"...","authDomain":"...","projectId":"..."}'></textarea>

      <div class="grid2" style="margin-top:10px">
        <div>
          <label class="muted">××–×”×” ×¤×•×¨×˜×œ (×—×™×™×‘ ×œ×”×™×•×ª ×–×”×” ×‘×›×œ ××—×©×‘)</label>
          <input id="cloudDocId" placeholder="kesem-shel-torah" />
        </div>
        <div class="row" style="align-items:flex-end">
          <button id="saveCloudCfgBtn" class="btn ok">×©××•×¨</button>
          <button id="connectCloudBtn" class="btn info">×”×¤×¢×œ ×¢× ×Ÿ</button>
        </div>
      </div>
    `;

    container.appendChild(div);

    const cfg = getCloudConfig();
    el("cloudCfg").value = cfg ? JSON.stringify(cfg, null, 2) : "";
    el("cloudDocId").value = getCloudDocId();

    const updateStatus = (txt, kind)=>{
      const s = el("cloudStatus");
      s.textContent = txt;
      s.classList.remove("ok","bad","warn");
      if(kind) s.classList.add(kind);
    };

    el("saveCloudCfgBtn").addEventListener("click", ()=>{
      const raw = el("cloudCfg").value.trim();
      if(!raw) return alert("×”×“×‘×§ JSON ×©×œ config");
      try{
        const obj = JSON.parse(raw);
        setCloudConfig(obj);
        const id = String(el("cloudDocId").value||"").trim() || CLOUD_DEFAULT_DOC;
        setCloudDocId(id);
        updateStatus("×¢× ×Ÿ: × ×©××¨ âœ… (×œ×—×¥ '×”×¤×¢×œ ×¢× ×Ÿ')","ok");
      }catch{
        alert("JSON ×œ× ×ª×§×™×Ÿ");
      }
    });

    el("connectCloudBtn").addEventListener("click", async ()=>{
      const id = String(el("cloudDocId").value||"").trim() || CLOUD_DEFAULT_DOC;
      setCloudDocId(id);
      const ok = await cloudInitIfPossible();
      if(!ok) return updateStatus("×¢× ×Ÿ: ×œ× ×”×¦×œ×™×— ×œ×”×ª×—×‘×¨ âŒ","bad");

      updateStatus("×¢× ×Ÿ: ×¤×¢×™×œ âœ…","ok");

      const remote = await cloudPullOnce();
      if(remote && remote.state){
        state = remote.state;
        ensureFixedPrizes();
        ensureSeedKids();
        saveStateLocal();
      }else{
        await cloudPushNow();
      }

      cloudSubscribe((data)=>{
        state = data.state;
        ensureFixedPrizes();
        ensureSeedKids();
        saveStateLocal();

        if(currentKidId){
          const kid = (state.kids||[]).find(k=>k.id===currentKidId);
          if(kid) renderKidPortal(kid);
        }
        if(!screens.settings.classList.contains("hidden")){
          renderKidsAdminList();
          renderPrizesAdminList();
        }
      });

      renderKidsAdminList();
      renderPrizesAdminList();
    });

    // initial status
    updateStatus(getCloudConfig() ? "×¢× ×Ÿ: ××•×’×“×¨ (×œ× ×¤×¢×™×œ)" : "×¢× ×Ÿ: ×œ× ××•×’×“×¨", getCloudConfig()?"warn":null);
  }


  function ensureFixedPrizes(){
    state.prizes = Array.isArray(state.prizes) ? state.prizes : [];

    // mark fixed + correct costs
    for(const fp of FIXED_PRIZES){
      const key = normalizeName(fp.name);
      let found = state.prizes.find(p=> normalizeName(p.name) === key);
      if(!found){
        state.prizes.push({ id: cryptoId(), name: fp.name, cost: fp.cost, fixed: true });
      }else{
        found.fixed = true;
        found.cost = fp.cost;
      }
    }

    // if user created duplicate fixed names, keep first fixed and rename others
    const seen = new Set();
    for(const p of state.prizes){
      const key = normalizeName(p.name||"");
      if(!key) continue;
      if(!seen.has(key)) seen.add(key);
      else {
        // avoid collisions silently
        p.name = (p.name || "") + " (2)";
      }
    }
  }

  function genUniqueCode(){
    const used = new Set((state.kids||[]).map(k=>String(k.code||"")));
    for(let tries=0; tries<2000; tries++){
      const n = Math.floor(Math.random()*1000);
      const c = String(n).padStart(3,"0");
      if(!used.has(c)) return c;
    }
    return String(Math.floor(Math.random()*1000)).padStart(3,"0");
  }

  function ensureSeedKids(){
    state.kids = Array.isArray(state.kids) ? state.kids : [];
    const existing = new Set(state.kids.map(k=> normalizeName(k.name || "")));
    const names = parseSeedNames(SEED_TEXT);
    let added = 0;
    for(const name of names){
      const key = normalizeName(name);
      if(existing.has(key)) continue;
      existing.add(key);
      state.kids.push({ id: cryptoId(), name, note: "", points: 0, code: genUniqueCode() });
      added++;
    }
    return added;
  }

  // ===== UI helpers =====
  const screens = {
    home: el("homeScreen"),
    kidPortal: el("kidPortalScreen"),
    settings: el("settingsScreen")
  };

  let currentKidId = null;

  function showOnly(screenKey){
    Object.keys(screens).forEach(k=>{
      screens[k].classList.toggle("hidden", k !== screenKey);
    });
  }

  function setModePill(text){ el("modePill").textContent = "××¦×‘: " + text; }

  function setStatus(targetId, msg, kind){
    const node = el(targetId);
    node.textContent = msg;
    node.classList.remove("ok","bad","warn");
    if(kind) node.classList.add(kind);
  }

  // ===== screens =====
  function gotoHome(){
    currentKidId = null;
    el("kidNameInput").value = "";
    showOnly("home");
    setModePill("×‘×™×ª");
    setStatus("homeStatus", "×¡×˜×˜×•×¡: ××•×›×Ÿ");
  }

  function gotoSettings(){
    showOnly("settings");
    setModePill("×”×’×“×¨×•×ª");
    renderKidsAdminList();
    renderPrizesAdminList();
    ensureCloudUi();
  }

  function openKidPortal(kidId){
    const kid = (state.kids||[]).find(k=>k.id===kidId);
    if(!kid) return;
    currentKidId = kid.id;
    showOnly("kidPortal");
    setModePill("×¤×•×¨×˜×œ ×™×œ×“");
    renderKidPortal(kid);
  }

  // ===== name search =====
  function findKidsByNameQuery(query){
    const q = normalizeName(query);
    if(!q) return [];

    const kids = (state.kids||[]);

    // exact
    const exact = kids.filter(k=> normalizeName(k.name) === q);
    if(exact.length) return exact;

    const qTokens = q.split(" ").filter(Boolean);
    const matches = [];

    for(const k of kids){
      const nameNorm = normalizeName(k.name);
      const nameTokens = nameNorm.split(" ").filter(Boolean);
      const ok = qTokens.every(t => nameTokens.some(nt => nt.startsWith(t)));
      if(ok){
        let score = 0;
        if(nameNorm.startsWith(q)) score += 100;
        score += Math.min(50, q.length);
        matches.push({ kid: k, score });
      }
    }

    matches.sort((a,b)=> b.score - a.score || a.kid.name.localeCompare(b.kid.name,"he"));
    return matches.map(x=>x.kid);
  }

  function openPickModal(matches){
    const list = el("pickModalList");
    list.innerHTML = "";

    for(const k of matches){
      const row = document.createElement("div");
      row.className = "status";
      row.style.display = "flex";
      row.style.justifyContent = "space-between";
      row.style.alignItems = "center";
      row.style.gap = "10px";

      const name = document.createElement("div");
      name.innerHTML = "<strong>" + escapeHtml(k.name) + "</strong>" + (k.note ? (" <span class=\"muted\">â€” " + escapeHtml(k.note) + "</span>") : "");

      const btn = document.createElement("button");
      btn.className = "btn primary";
      btn.textContent = "×‘×—×¨";
      btn.addEventListener("click", ()=>{
        closePickModal();
        setStatus("homeStatus", "× ×‘×—×¨ âœ…", "ok");
        openKidPortal(k.id);
      });

      row.appendChild(name);
      row.appendChild(btn);
      list.appendChild(row);
    }

    el("pickModalBackdrop").classList.add("show");
  }

  function closePickModal(){
    el("pickModalBackdrop").classList.remove("show");
    el("pickModalList").innerHTML = "";
  }

  function enterByNameFlow(){
    const q = el("kidNameInput").value;
    const matches = findKidsByNameQuery(q);

    if(matches.length === 0){
      setStatus("homeStatus", "×œ× × ××¦× ×™×œ×“ ×¢× ×”×©× ×”×–×” âŒ", "bad");
      return;
    }

    if(matches.length === 1){
      setStatus("homeStatus", "× ××¦× âœ…", "ok");
      openKidPortal(matches[0].id);
      return;
    }

    setStatus("homeStatus", "××¦××ª×™ ×›××” ×ª×•×¦××•×ªâ€¦", "warn");
    openPickModal(matches);
  }

  // ===== kids admin =====
  function renderKidsAdminList(){
    const box = el("kidsAdminList");
    box.innerHTML = "";

    const kids = (state.kids || []).slice().sort((a,b)=> a.name.localeCompare(b.name,"he"));
    if(kids.length === 0){
      box.innerHTML = '<div class="status bad">××™×Ÿ ×™×œ×“×™× ×¢×“×™×™×Ÿ.</div>';
      return;
    }

    kids.forEach((k, idx)=>{
      const div = document.createElement("div");
      div.className = "status";
      div.textContent = (idx+1) + ") " + k.name + (k.note ? " â€” " + k.note : "") + (k.code ? " â€¢ ×§×•×“: " + k.code : "");
      box.appendChild(div);
    });
  }

  function addKid(){
    const name = String(el("newKidName").value||"").trim().replace(/\s+/g, " ");
    const note = String(el("newKidNote").value||"").trim();
    if(!name) return alert("×¦×¨×™×š ×©×");

    const key = normalizeName(name);
    if((state.kids||[]).some(k=> normalizeName(k.name) === key)){
      alert("×”×©× ×›×‘×¨ ×§×™×™×");
      return;
    }

    state.kids = state.kids || [];
    state.kids.push({ id: cryptoId(), name, note, points: 0, code: genUniqueCode() });

    el("newKidName").value = "";
    el("newKidNote").value = "";

    saveState();
    renderKidsAdminList();
  }

  function parseBulkKidsText(text){
    const raw = String(text || "");
    const replaced = raw.split(";").join(NL).split(",").join(NL);
    const lines = replaced.split(NL).map(s=>s.trim()).filter(Boolean);

    const bannedWords = ["×›×™×ª×”", "×§×•×“", "×¤×¨×¡", "×¤×¨×¡×™×", "×™×œ×“×™×", "× ×§", "× ×§×•×“×•×ª"];

    function cleanupName(line){
      let name = String(line || "").trim();
      const pipeIdx = name.indexOf("|");
      const dashIdx = name.indexOf(" - ");
      if(pipeIdx >= 0) name = name.slice(0, pipeIdx).trim();
      else if(dashIdx >= 0) name = name.slice(0, dashIdx).trim();
      name = name.replace(/\s+/g, " ").trim();
      name = name.replace(/[\-â€“â€”,:;]+$/g, "").trim();
      return name;
    }

    function isProbablyNameLine(line){
      const s = String(line || "").trim();
      if(!s) return false;
      if(/^\d+$/.test(s)) return false;

      const lower = s.toLowerCase();
      for(const w of bannedWords){
        if(lower.includes(w)) return false;
      }

      const heb = s.match(/[×-×ª]/g);
      if(!heb || heb.length < 2) return false;
      const words = s.split(/\s+/).filter(w=>/[×-×ª]/.test(w));
      return words.length >= 2;
    }

    const names = [];
    for(const line of lines){
      if(!isProbablyNameLine(line)) continue;
      const name = cleanupName(line);
      if(name) names.push(name);
    }

    const seen = new Set();
    const out = [];
    for(const name of names){
      const key = normalizeName(name);
      if(seen.has(key)) continue;
      seen.add(key);
      out.push(name);
    }
    return out;
  }

  function bulkAddKids(){
    const names = parseBulkKidsText(el("bulkKidsInput").value);
    if(names.length === 0){
      setStatus("bulkKidsStatus", "×œ× × ××¦××• ×©××•×ª âŒ", "bad");
      return;
    }

    state.kids = state.kids || [];
    const existing = new Set(state.kids.map(k=> normalizeName(k.name||"")));

    let added = 0;
    for(const name of names){
      const key = normalizeName(name);
      if(existing.has(key)) continue;
      existing.add(key);
      state.kids.push({ id: cryptoId(), name, note: "", points: 0, code: genUniqueCode() });
      added++;
    }

    saveState();
    renderKidsAdminList();
    setStatus("bulkKidsStatus", "× ×•×¡×¤×• " + added + " ×©××•×ª âœ…", "ok");
  }

  function resetAllData(){
    if(!confirm("×œ××¤×¡ ××ª ×›×œ ×”× ×ª×•× ×™×?")) return;
    localStorage.removeItem(STORAGE_KEY);
    state = makeDefaultState();
    ensureFixedPrizes();
    ensureSeedKids();
    saveState();
    gotoHome();
  }

  // ===== prizes admin =====
  function renderPrizesAdminList(){
    const box = el("prizesAdminList");
    box.innerHTML = "";

    const prizes = (state.prizes||[]).slice().sort((a,b)=> (a.cost||0)-(b.cost||0) || String(a.name||"").localeCompare(String(b.name||""),"he"));
    if(prizes.length === 0){
      box.innerHTML = '<div class="status bad">××™×Ÿ ×¤×¨×¡×™×.</div>';
      return;
    }

    prizes.forEach((p, idx)=>{
      const row = document.createElement("div");
      row.className = "status";
      row.style.display = "flex";
      row.style.justifyContent = "space-between";
      row.style.alignItems = "center";
      row.style.gap = "10px";

      const left = document.createElement("div");
      left.innerHTML = '<strong>' + (idx+1) + ") " + escapeHtml(p.name) + '</strong> â€¢ ' + (p.cost||0) + ' × ×§×³ ' + (p.fixed ? '<span class="badge">×§×‘×•×¢</span>' : '');

      const actions = document.createElement("div");
      actions.className = "row";

      const edit = document.createElement("button");
      edit.className = "btn info";
      edit.textContent = "×©× ×”";
      edit.disabled = !!p.fixed;
      edit.title = p.fixed ? "×¤×¨×¡ ×§×‘×•×¢" : "×©× ×” ×©×/××—×™×¨";
      edit.addEventListener("click", ()=> editPrize(p.id));

      const del = document.createElement("button");
      del.className = "btn danger";
      del.textContent = "××—×§";
      del.disabled = !!p.fixed;
      del.title = p.fixed ? "×¤×¨×¡ ×§×‘×•×¢" : "××—×§ ×¤×¨×¡";
      del.addEventListener("click", ()=> deletePrize(p.id));

      actions.appendChild(edit);
      actions.appendChild(del);

      row.appendChild(left);
      row.appendChild(actions);
      box.appendChild(row);
    });
  }

  function addPrize(){
    const name = String(el("newPrizeName").value||"").trim().replace(/\s+/g," ");
    const cost = Math.floor(Number(el("newPrizeCost").value));
    if(!name) return alert("×¦×¨×™×š ×©× ×¤×¨×¡");
    if(!isFinite(cost) || cost < 0) return alert("××—×™×¨ ×œ× ×ª×§×™×Ÿ");

    const key = normalizeName(name);
    if((state.prizes||[]).some(p=> normalizeName(p.name) === key)){
      alert("×›×‘×¨ ×§×™×™× ×¤×¨×¡ ×‘×©× ×”×–×”");
      return;
    }

    state.prizes = state.prizes || [];
    state.prizes.push({ id: cryptoId(), name, cost, fixed: false });

    el("newPrizeName").value = "";
    el("newPrizeCost").value = "";

    saveState();
    renderPrizesAdminList();

    if(currentKidId){
      const kid = (state.kids||[]).find(k=>k.id===currentKidId);
      if(kid) renderKidPortal(kid);
    }
  }

  function editPrize(prizeId){
    const prize = (state.prizes||[]).find(p=>p.id===prizeId);
    if(!prize || prize.fixed) return;

    const newName = prompt("×©× ×¤×¨×¡ ×—×“×©", prize.name);
    if(newName === null) return;
    const name = String(newName).trim().replace(/\s+/g," ");
    if(!name) return alert("×©× ×œ× ×ª×§×™×Ÿ");

    const newCostRaw = prompt("××—×™×¨ ×—×“×© ×‘× ×§×•×“×•×ª", String(prize.cost||0));
    if(newCostRaw === null) return;
    const cost = Math.floor(Number(newCostRaw));
    if(!isFinite(cost) || cost < 0) return alert("××—×™×¨ ×œ× ×ª×§×™×Ÿ");

    const key = normalizeName(name);
    if((state.prizes||[]).some(p=> p.id!==prizeId && normalizeName(p.name)===key)){
      return alert("×›×‘×¨ ×§×™×™× ×¤×¨×¡ ×‘×©× ×”×–×”");
    }

    prize.name = name;
    prize.cost = cost;

    saveState();
    renderPrizesAdminList();

    if(currentKidId){
      const kid = (state.kids||[]).find(k=>k.id===currentKidId);
      if(kid) renderKidPortal(kid);
    }
  }

  function deletePrize(prizeId){
    const prize = (state.prizes||[]).find(p=>p.id===prizeId);
    if(!prize || prize.fixed) return;
    if(!confirm("×œ××—×•×§ ××ª ×”×¤×¨×¡: " + prize.name + " ?")) return;

    state.prizes = (state.prizes||[]).filter(p=>p.id!==prizeId);

    saveState();
    renderPrizesAdminList();

    if(currentKidId){
      const kid = (state.kids||[]).find(k=>k.id===currentKidId);
      if(kid) renderKidPortal(kid);
    }
  }

  function resetCustomPrizes(){
    if(!confirm("×œ××¤×¡ ×¤×¨×¡×™×? ×–×” ×™××—×§ ×¨×§ ×¤×¨×¡×™× ×©×”×•×¡×¤×ª (×”×§×‘×•×¢×™× ×™×™×©××¨×•).")) return;
    state.prizes = (state.prizes||[]).filter(p=>p.fixed);
    ensureFixedPrizes();

    saveState();
    renderPrizesAdminList();

    if(currentKidId){
      const kid = (state.kids||[]).find(k=>k.id===currentKidId);
      if(kid) renderKidPortal(kid);
    }
  }

  // ===== kid portal =====
  function renderKidPortal(kid){
    el("kidNameTitle").textContent = kid.name;
    el("kidNoteTitle").textContent = kid.note || "";
    el("kidPoints").textContent = String(kid.points || 0);

    const box = el("prizesStoreList");
    box.innerHTML = "";

    const prizes = (state.prizes||[]).slice().sort((a,b)=> (a.cost||0)-(b.cost||0));
    if(prizes.length === 0){
      box.innerHTML = '<div class="status bad">××™×Ÿ ×¤×¨×¡×™×. ×”×•×¡×£ ×‘×”×’×“×¨×•×ª.</div>';
      return;
    }

    for(const p of prizes){
      const canBuy = (kid.points||0) >= (p.cost||0);
      const div = document.createElement("div");
      div.className = "status";
      div.style.display = "flex";
      div.style.justifyContent = "space-between";
      div.style.alignItems = "center";
      div.style.gap = "10px";

      const left = document.createElement("div");
      left.innerHTML = '<strong>' + escapeHtml(p.name) + '</strong> â€¢ ' + (p.cost||0) + ' × ×§×³ ' + (p.fixed ? '<span class="badge">×§×‘×•×¢</span>' : '');

      const right = document.createElement("div");
      if(canBuy){
        const btn = document.createElement("button");
        btn.className = "btn ok";
        btn.textContent = "×§× ×”";
        btn.addEventListener("click", ()=> buyPrize(kid.id, p.id));
        right.appendChild(btn);
      }else{
        const badge = document.createElement("span");
        badge.className = "badge";
        badge.textContent = "× ×¢×•×œ";
        right.appendChild(badge);
      }

      div.appendChild(left);
      div.appendChild(right);
      box.appendChild(div);
    }
  }

  function adjustPoints(delta){
    if(!currentKidId) return;
    const kid = (state.kids||[]).find(k=>k.id===currentKidId);
    if(!kid) return;
    kid.points = Math.max(0, Math.floor(Number(kid.points||0) + delta));
    saveState();
    renderKidPortal(kid);
  }

  function buyPrize(kidId, prizeId){
    const kid = (state.kids||[]).find(k=>k.id===kidId);
    const prize = (state.prizes||[]).find(p=>p.id===prizeId);
    if(!kid || !prize) return;
    if((kid.points||0) < (prize.cost||0)) return alert("××™×Ÿ ××¡×¤×™×§ × ×§×•×“×•×ª");
    kid.points -= prize.cost;
    saveState();
    renderKidPortal(kid);
  }

  // ===== admin modal =====
  function validateAdminCode(code){
    const c = String(code||"").trim();
    return (state.adminCodes||[]).includes(c);
  }

  function openAdminModal(){
    el("adminCodeInput").value = "";
    setStatus("adminModalStatus", "×¡×˜×˜×•×¡: ××•×›×Ÿ");
    el("adminModalBackdrop").classList.add("show");
    setTimeout(()=> el("adminCodeInput").focus(), 0);
  }

  function closeAdminModal(){
    el("adminModalBackdrop").classList.remove("show");
  }

  function tryAdminEnter(){
    const code = el("adminCodeInput").value;
    if(validateAdminCode(code)){
      setStatus("adminModalStatus", "× ×›×•×Ÿ âœ…", "ok");
      closeAdminModal();
      gotoSettings();
    }else{
      setStatus("adminModalStatus", "×§×•×“ ×©×’×•×™ âŒ", "bad");
    }
  }

  // ===== printing =====
  function openPrintCards(){
    const kids = (state.kids||[]).slice().sort((a,b)=> a.name.localeCompare(b.name,"he"));
    if(kids.length === 0){
      alert("××™×Ÿ ×™×œ×“×™× ×œ×”×“×¤×¡×”");
      return;
    }

    const area = el("printArea");
    area.classList.remove("hidden");

    const cards = kids.map(k=>{
      const code = k.code ? String(k.code) : "";
      return '<div class="print-card"><div class="name">' + escapeHtml(k.name) + '</div><div class="code">×§×•×“: <strong>' + escapeHtml(code) + '</strong></div></div>';
    }).join("");

    area.innerHTML = '<div class="print-grid">' + cards + '</div>';

    window.print();

    // hide after print
    setTimeout(()=>{
      area.classList.add("hidden");
      area.innerHTML = "";
    }, 200);
  }

  // ===== tests =====
  function runTests(){
    const assert = (cond, msg)=>{ if(!cond) throw new Error("TEST FAILED: " + msg); };

    assert(normalizeName("  × ×‘×•   ×¨×•×˜ ") === "× ×‘×• ×¨×•×˜".toLowerCase(), "normalizeName trims/collapses");

    // partial matching
    const prev = state;
    state = { adminCodes:["2590"], kids:[{id:"1",name:"× ×‘×• ×¨×•×˜",note:"",points:0,code:"111"},{id:"2",name:"× ×‘×• ×›×”×Ÿ",note:"",points:0,code:"222"}], prizes:[] };
    assert(findKidsByNameQuery("× ×‘×•").length === 2, "partial query returns multiple matches");
    assert(findKidsByNameQuery("× ×‘×• ×¨").length === 1, "multi-token prefix narrows");
    state = prev;

    console.log("All tests passed âœ…");
  }

  // ===== events =====
  function wireEvents(){
    el("goHomeBtn").addEventListener("click", gotoHome);
    el("backToHomeBtn").addEventListener("click", gotoHome);
    el("closeSettingsBtn").addEventListener("click", gotoHome);

    el("settingsBtn").addEventListener("click", openAdminModal);
    el("adminCancelBtn").addEventListener("click", closeAdminModal);
    el("adminEnterBtn").addEventListener("click", tryAdminEnter);
    el("adminCodeInput").addEventListener("keydown", (e)=>{ if(e.key === "Enter") tryAdminEnter(); });

    el("pickCancelBtn").addEventListener("click", closePickModal);
    el("pickModalBackdrop").addEventListener("click", (e)=>{ if(e.target === el("pickModalBackdrop")) closePickModal(); });

    el("adminModalBackdrop").addEventListener("click", (e)=>{ if(e.target === el("adminModalBackdrop")) closeAdminModal(); });

    document.addEventListener("keydown", (e)=>{
      if(e.key === "Escape"){
        closeAdminModal();
        closePickModal();
      }
    });

    el("enterByNameBtn").addEventListener("click", enterByNameFlow);
    el("kidNameInput").addEventListener("keydown", (e)=>{ if(e.key === "Enter") enterByNameFlow(); });
    el("clearKidNameBtn").addEventListener("click", ()=>{ el("kidNameInput").value = ""; setStatus("homeStatus","×¡×˜×˜×•×¡: ××•×›×Ÿ"); });

    el("kidAdd10Btn").addEventListener("click", ()=> adjustPoints(10));
    el("kidSub10Btn").addEventListener("click", ()=> adjustPoints(-10));
    el("kidAdd1Btn").addEventListener("click", ()=> adjustPoints(1));
    el("kidSub1Btn").addEventListener("click", ()=> adjustPoints(-1));
    el("kidAddCustomBtn").addEventListener("click", ()=>{
      const n = Math.floor(Number(el("kidCustomDelta").value));
      if(!isFinite(n) || n < 0) return alert("×›××•×ª ×œ× ×ª×§×™× ×”");
      adjustPoints(n);
      el("kidCustomDelta").value = "";
    });
    el("kidSubCustomBtn").addEventListener("click", ()=>{
      const n = Math.floor(Number(el("kidCustomDelta").value));
      if(!isFinite(n) || n < 0) return alert("×›××•×ª ×œ× ×ª×§×™× ×”");
      adjustPoints(-n);
      el("kidCustomDelta").value = "";
    });

    el("addKidBtn").addEventListener("click", addKid);
    el("resetDemoDataBtn").addEventListener("click", resetAllData);

    el("bulkAddKidsBtn").addEventListener("click", bulkAddKids);
    el("bulkClearKidsBtn").addEventListener("click", ()=>{ el("bulkKidsInput").value = ""; setStatus("bulkKidsStatus","×¡×˜×˜×•×¡: ××•×›×Ÿ"); });

    el("addPrizeBtn").addEventListener("click", addPrize);
    el("resetPrizesBtn").addEventListener("click", resetCustomPrizes);

    el("printCardsBtn").addEventListener("click", openPrintCards);
  }

  function openLoginModal(){
    el("loginUsernameInput").value = "";
    setStatus("loginStatus","×¡×˜×˜×•×¡: ××•×›×Ÿ");
    el("loginModalBackdrop").classList.add("show");
    setTimeout(()=> el("loginUsernameInput").focus(), 0);
  }

  function closeLoginModal(){
    el("loginModalBackdrop").classList.remove("show");
  }

  function tryLogin(){
    const u = String(el("loginUsernameInput").value||"").trim();
    if(u === REQUIRED_USERNAME){
      sessionStorage.setItem(SESSION_LOGIN_KEY, "1");
      setStatus("loginStatus","× ×›×•×Ÿ âœ…","ok");
      closeLoginModal();
      initApp();
    }else{
      setStatus("loginStatus","×©× ××©×ª××© ×©×’×•×™ âŒ","bad");
    }
  }

  async function initApp(){
    if(initApp._ran) return;
    initApp._ran = true;

    if(!state){
      state = makeDefaultState();
    }

    // ×× ×™×© ×¢× ×Ÿ ×©××•×’×“×¨ ×›×‘×¨ â€” ××¤×¢×™×œ×™× ××•×˜×•××˜×™×ª
    const cloudOk = await cloudInitIfPossible();
    if(cloudOk){
      const remote = await cloudPullOnce();
      if(remote && remote.state){
        state = remote.state;
      }
    }

    ensureFixedPrizes();
    ensureSeedKids();
    saveStateLocal();

    if(cloudOk){
      await cloudPushNow();
      cloudSubscribe((data)=>{
        state = data.state;
        ensureFixedPrizes();
        ensureSeedKids();
        saveStateLocal();

        if(currentKidId){
          const kid = (state.kids||[]).find(k=>k.id===currentKidId);
          if(kid) renderKidPortal(kid);
        }
        if(!screens.settings.classList.contains("hidden")){
          renderKidsAdminList();
          renderPrizesAdminList();
        }
      });
    }

    wireEvents();
    gotoHome();

    if(location.hash && location.hash.toLowerCase().includes("test")){
      runTests();
      alert("×›×œ ×”×˜×¡×˜×™× ×¢×‘×¨×• âœ… (×¨××• Console)");
    }
  }

  function init(){
    // ×›× ×™×¡×” ×—×•×‘×” ×‘×›×œ ×¤×ª×™×—×” (×œ× × ×©××¨ ×‘×™×Ÿ ×˜××‘×™×)
    sessionStorage.removeItem(SESSION_LOGIN_KEY);

    // ××™×¨×•×¢×™× ×©×œ ××•×“××œ ×›× ×™×¡×”
    el("loginEnterBtn").addEventListener("click", tryLogin);
    el("loginUsernameInput").addEventListener("keydown", (e)=>{ if(e.key === "Enter") tryLogin(); });

    // ××¦×™×’×™× ××•×“××œ ×›× ×™×¡×”
    openLoginModal();
  }

  init();
})();
</script>
</body>
</html>
